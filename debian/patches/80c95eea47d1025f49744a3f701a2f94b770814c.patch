From 80c95eea47d1025f49744a3f701a2f94b770814c Mon Sep 17 00:00:00 2001
From: Mathieu Malaterre <mathieu.malaterre@gmail.com>
Date: Mon, 28 Nov 2022 14:46:32 +0100
Subject: [PATCH] Support for IlmBase versions < 3.1 is deprecated and will be
 removed

---
 openvdb_cmd/vdb_tool/CMakeLists.txt | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/openvdb_cmd/vdb_tool/CMakeLists.txt b/openvdb_cmd/vdb_tool/CMakeLists.txt
index f9b846b8a..f863d7f24 100644
--- a/openvdb_cmd/vdb_tool/CMakeLists.txt
+++ b/openvdb_cmd/vdb_tool/CMakeLists.txt
@@ -92,8 +92,13 @@ endif()
 
 if(OPENVDB_TOOL_USE_EXR)
   target_compile_definitions(vdb_tool_common INTERFACE "VDB_TOOL_USE_EXR")
+  find_package(Imath REQUIRED)
   find_package(OpenEXR REQUIRED)
-  target_link_libraries(vdb_tool_common INTERFACE OpenEXR::IlmImf)
+  target_link_libraries(vdb_tool_common INTERFACE
+  # For Imath/OpenEXR v3.X
+  $<TARGET_NAME_IF_EXISTS:Imath::Imath>
+  $<TARGET_NAME_IF_EXISTS:OpenEXR::OpenEXR>
+)
 endif()
 
 if(OPENVDB_TOOL_USE_ABC)
